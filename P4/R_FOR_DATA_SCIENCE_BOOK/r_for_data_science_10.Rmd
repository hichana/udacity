---
title: "R for Data Science 10"
author: "Matt Chana"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

### 10.1 Introduction
Tibbles are data frames but they make life easier. 

### 10.2 Creating Tibbles
To coerce a data frame as a tibble:
```{r}
as_tibble(iris)
```

Create a new tible with individual vectors:
```{r}
tibble(
  x = 1:5,
  y = 1,
  z = x ^ 2 + y
)
```

Tibbles never change data types automatically - like converting strings to factors. It never creates row names. If for some reason need column names that are not valid R vairable names (ex. not starting with a letter, or containing special characters), surround with backticks:
```{r}
tb <- tibble(
  `:)` = "smile",
  ` ` = "space",
  `2000` = "number"
)
tb
```

The backticks will be needed when working with packages like `ggplot2`, `dplyr` and `tidyr`. 

To lay out data manually in an easy to read format and have it display the same way, use "tribble", which is short for "transposed tibble":
```{r}
tribble(
  ~x, ~y, ~z,
  "a", 2, 3.6,
  "b", 1, 8.5
)
```

### 10.3.1 Printing
Tibbles only show the first 10 rows when printing to make easier working iwth large data:
```{r}
tibble(
  a = lubridate::now() + runif(1e3) * 86400,
  b = lubridate::today() + runif(1e3) * 30,
  c = 1:1e3,
  d = runif(1e3),
  e = sample(letters, 1e3, replace = TRUE)
)
```

Control number of rows and column:
```{r}
nycflights13::flights %>%
  print(n = 10, width = Inf)
```

Set options to do the same (if more than the min rows, print the max):
```{r}
options(tibble.print_max = 20, tibble.print_min = 5)
```

Always show all rows:
```{r}
options(dplyr.print_min = Inf)
```

Print all columns regardless of width of screen:
```{r}
options(tibble.width = Inf)
```

Show a complete list of options:
```{r}
package?tibble
```

Use RStudio's built-in data viewer to get scrollable view of complete dataset:
```{r}
nycflights13::flights %>%
  View()
```

### 10.3.2 Subsetting

Check function:
```{r}
?runif()
```

Check function:
```{r}
?rnorm()
```

Create tibble:
```{r}
df <- tibble(
  x = runif(5), # random deviates on uniform dist
  y = rnorm(5) # random gen from normal dist
)
df
```

Subset from within a pipe:
```{r}
df %>% .$x
```

or...
```{r}
df %>% .[["x"]]
```

Unlike data.frame, tibbles are strict and never do partial matching.

### 10.4 Interacting with Older Code
Go back to a data frame:
```{r}
class(as.data.frame(tb))
```

Make into a variable:
```{r}
new_df <- as.data.frame(tb)
new_df
```

`[]` is not used much in this book because `dplyr::filter()` and `dplyr::select()` solve same problem with clearer code. With R data frames, `[]` sometimes returns a data frame and sometimes a vector.

# 10.5 Exercises
TODO